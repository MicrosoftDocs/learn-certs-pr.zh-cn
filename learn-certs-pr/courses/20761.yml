### YamlMime:Course
title: Querying Data with Transact-SQL
metadata:
  title: 'Course 20761-C: Querying Data with Transact-SQL'
  description: 'Course 20761-C: Querying Data with Transact-SQL'
uid: course.20761
courseNumber: '20761-C'
hoursToComplete: 120
iconUrl: /media/learn/certification/course.svg
skillsGained:
- skill: 描述 SQL Server 的关键功能和组件。
- skill: 描述 T-SQL、集合和谓词逻辑。
- skill: 编写单表 SELECT 语句。
- skill: 编写多表 SELECT 语句。
- skill: 编写具有过滤和排序功能的 SELECT 语句。
- skill: 描述 SQL Server 如何使用数据类型。
- skill: 编写 DML 语句。
- skill: 编写使用内置函数的查询。
- skill: 编写汇总数据的查询。
- skill: 编写子查询。
- skill: 创建和实现视图和表值函数。
- skill: 使用集合运算符组合查询结果。
- skill: 编写使用窗口排名、偏移量和汇总函数的查询。
- skill: 通过实现数据透视图、取消透视图、汇总和多维数据集来转换数据。
- skill: 创建和实现存储程序。
- skill: 向 T-SQL 代码添加编程构造，例如变量、条件和循环。
learningPartnersLink: /learn/certifications/partners
locales:
- en
levels:
- intermediate
roles:
- database-administrator
products:
- sql-server
exams:
- uid: exam.70-761
summary: |-
  本课程旨在向学生介绍 Transact-SQL。它的设计方式是，可以将前三天作为一门课程教授给需要 SQL Server 课程中的其他课程知识的学生。第4天和第5天讲授参加考试 70-761 所需的其余技能。

  #### 受众概况
  本课程的主要目的是使学生对所有 SQL Server 相关学科都使用的 Transact-SQL 语言有很好的了解，即数据库管理、数据库开发和商业智能。因此，本课程的主要目标受众是：数据库管理员、数据库开发人员和 BI 专业人员。
prerequisitesSection: |-
  - Microsoft Windows 操作系统及其核心功能的基本知识。
  - 关系型数据库如何工作的知识。
outlineSection: |-
  ### 模块 1&#58; Microsoft SQL Server 导论
  本模块介绍 SQL Server、SQL Server 的版本（包括云版本）以及如何使用 SQL Server Management Studio 连接到 SQL Server。
  #### 课程
  - SQL Server 的基本架构
  - SQL Server 版本
  - SQL Server Management Studio 入门


  #### 实验&#58; 使用 SQL Server 工具
  - 使用 SQL Server Management Studio
  - 创建和组织 T-SQL 脚本
  - 使用 Books Online

  完成本模块后，您将能够&#58; 
  - 描述关系型数据库和 Transact-SQL 查询。
  - 描述 SQL Server 的本地和基于云的版本。
  - 描述如何使用 SQL Server Management Studio（SSMS）连接到 SQL Server 实例，浏览该实例中包含的数据库以及如何使用包含 T-SQL 查询的脚本文件。


  ### 模块 2&#58; T-SQL 查询导论
  本模块描述了 T-SQL 的元素及其在编写查询中的作用。描述 SQL Server 中集合的用法。描述 SQL Server 中谓词逻辑的使用。在 SELECT 语句中描述操作的逻辑顺序。


  #### 课程
  - 介绍 T-SQL
  - 了解集合
  - 了解谓词逻辑
  - 了解 SELECT 语句中的操作逻辑顺序


  #### 实验&#58; T-SQL 查询导论
  - 执行基本的 SELECT 语句
  - 执行使用谓词筛选数据的查询
  - 执行使用 ORDER BY 对数据进行排序的查询

  完成本模块后，您将能够&#58; 
  - 描述 T-SQL 在编写 SELECT 语句中的作用。
  - 描述 T-SQL 语言的元素以及哪些元素在编写查询时将很有用。
  - 描述集合论的概念，这是关系型数据库的数学基础之一，并帮助您将其应用于如何考虑查询 SQL Server
  - 描述谓词逻辑并检查其在查询 SQL Server 中的应用。
  - 说明 SELECT 语句的元素，描述评估元素的顺序，然后将此理解应用于编写查询的实践方法。


  ### 模块 3&#58; 编写 SELECT 查询
  本模块介绍 SELECT 语句的基础，重点是针对单一数据表的查询。
  #### 课程
  - 编写简单的 SELECT 语句
  - 使用 DISTINCT 消除重复
  - 使用数据行和数据表别名
  - 编写简单的 CASE 表达式


  #### 实验&#58; 编写基本的 SELECT 语句
  - 编写简单的 SELECT 语句
  - 使用 DISTINCT 消除重复
  - 使用数据行和数据表别名
  - 使用简单的 CASE 表达式

  完成本模块后，您将能够&#58; 
  - 描述 SELECT 语句的结构和格式，以及向查询增加功能和可读性的增强技术
  - 描述如何使用 DISTINCT 子句消除重复项
  - 描述数据行和数据表别名的使用
  - 了解和使用 CASE 表达式


  ### 模块 4&#58; 查询多个数据表
  本模块描述如何编写将 Microsoft SQL Server 中多个来源的数据合并在一起的查询。


  #### 课程
  - 了解 Joins
  - 使用 Inner Joins 进行查询
  - 使用 Outer Joins 进行查询
  - 使用 Cross Joins 和 Self Joins 进行查询


  #### 实验&#58; 查询多个数据表
  - 编写使用 Inner Joins 的查询
  - 编写使用多表 Inner Joins 的查询
  - 编写使用 Self-Joins 的查询
  - 编写使用 Outer Joins 的查询
  - 编写使用 Cross Joins 的查询

  完成本模块后，您将能够&#58; 
  - 解释 SQL Server 中的联接基础 
  - 编写内部联接查询
  - 编写使用外部联接的查询 
  - 使用其他联接类型


  ### 模块 5&#58; 排序和筛选数据
  本模块描述如何实现排序和筛选。
  #### 课程
  - 对数据进行排序
  - 使用 Predicates 筛选数据
  - 使用 TOP 和 OFFSET-FETCH 筛选数据
  - 使用未知值


  #### 实验&#58; 排序和筛选数据
  - 编写使用 WHERE 子句筛选数据的查询
  - 编写使用 ORDER By 子句对数据进行排序的查询
  - 编写使用 TOP 选项筛选数据的查询
  - 写写使用 OFFSET-FETCH 子句筛选数据的查询

  完成本模块后，您将能够&#58; 
  - 说明如何在查询中添加 ORDER BY 子句以控制查询输出中显示的行顺序
  - 说明如何构造 WHERE 子句以筛选出与谓词不匹配的行。
  - 说明如何使用 TOP 选项限制 SELECT 子句中的行范围。 
  - 说明如何使用 ORDER BY 子句的 OFFSET-FETCH 选项限制行范围。
  - 说明三值逻辑如何解释未知值和缺失值，SQL Server 如何使用 NULL 标记缺失值以及如何在查询中测试 NULL。

  ### 模块 6&#58; 使用 SQL Server 数据类型
  本模块介绍了 SQL Server 用于存储数据的数据类型。
  #### 课程
  - 介绍 SQL Server 数据类型
  - 使用字符数据
  - 使用日期和时间数据


  #### 实验&#58; 使用 SQL Server 数据类型
  - 编写返回日期和时间数据的查询
  - 编写使用日期和时间函数的查询
  - 编写返回字符数据的查询
  - 编写返回字符功能的查询

  完成本模块后，您将能够&#58; 
  - 探索 SQL Server 用于存储数据的许多数据类型以及如何在类型之间转换数据类型
  - 说明基于 SQL Server 字符的数据类型、字符比较的工作方式以及部分可能对查询有用的常用功能
  - 描述用于存储时态数据的数据类型、如何输入日期和时间，以便 SQL Server 正确解析它们，以及如何使用内置函数操作日期和时间。


  ### 模块 7&#58; 使用 DML 修改数据
  本模块描述如何创建 DML 查询以及为什么要创建。
  #### 课程
  - 将数据添加到表
  - 修改和删除数据
  - 生成自动列值


  #### 实验&#58; 使用 DML 修改数据
  - 使用 DML 插入记录
  - 使用 DML 更新和删除记录

  完成本模块后，您将能够&#58; 
  - 使用 INSERT 和 SELECT INTO 语句
  - 使用UPDATE、MERGE、DELETE 和 TRUNCATE。


  ### 模块 8&#58; 使用内建功能
  本模块介绍了 SQL Server 中的其中部分内置函数。
  #### 课程
  - 使用内建函数编写查询
  - 使用转换函数
  - 使用逻辑函数
  - 使用函数以使用 NULL


  #### 实验&#58; 使用内建函数
  - 编写使用转换函数的查询
  - 编写使用逻辑函数的查询
  - 编写测试空属性的查询

  完成本模块后，您将能够&#58; 
  - 描述 SQL Server 提供的函数的类型，然后重点是处理标量函数
  - 说明如何使用多个 SQL Server 函数在类型之间显式转换数据
  - 描述如何使用评估表达式并返回标量结果的逻辑函数。
  - 描述使用 NULL 的其他功能


  ### 模块 9&#58; 分组和汇总资料
  本模块描述如何使用聚合函数。
  #### 课程
  - 使用聚合函数
  - 使用 GROUP BY 子句
  - 使用 HAVING 筛选群组


  #### 实验&#58; 分组和汇总资料
  - 编写使用GROUP BY子句的查询
  - 编写使用聚合函数的查询
  - 编写使用不同聚合函数的查询
  - 编写使用 HAVING 子句筛选组的查询

  完成本模块后，您将能够&#58; 
  - 描述 SQL Server 中的内置聚合函数，并使用此函数编写查询。
  - 编写使用 GROUP By 子句分隔行的查询。
  - 编写使用 HAVING 子句筛选组的查询。


  ### 模块 10&#58; 使用子查询
  本模块描述了几种类型的子查询以及如何以及何时使用它们。
  #### 课程
  - 编写自包含子查询
  - 编写相关子查询
  - 将 EXISTS 谓词与子查询一起使用


  #### 实验&#58; 使用子查询
  - 编写使用自包含子查询的查询
  - 编写使用标量和多结果子查询的查询
  - 编写使用相关子查询和 EXISTS 子句的查询

  完成本模块后，您将能够&#58; 
  - 描述在 SELECT 语句中何处可以使用子查询。
  - 编写在 SELECT 语句中使用相关子查询的查询
  - 编写在 WHERE 子句中使用 EXISTS 谓词的查询，以测试是否存在合格行
  - 使用 EXISTS 谓词可以有效检查子查询中是否存在列。


  ### 模块 11&#58; 使用数据表表达式
  在本课程的前面，您学习瞭如何使用子查询作为将结果返回给外部调用查询的表达式。像子查询一样，数据表表达式是查询表达式，但是数据表表达式通过允许您命名它们并使用它们的结果来扩展此概念，就像使用任何有效关系表中的数据一样。Microsoft SQL Server 支持四种类型的数据表表达式&#58;派生表、通用数据表表达式（CTE）、视图和内联表值函数（TVF）。在本模块中，您将学习使用这些形式的数据表表达式，并学习如何使用它们来帮助创建用于编写查询的模块化方法。
  #### 课程
  - 使用视图
  - 使用内联数据表值函数
  - 使用衍生数据表
  - 使用通用数据表表达式


  #### 实验&#58; 使用数据表表达式
  - 编写使用视图的查询
  - 编写使用派生表的查询
  - 编写使用通用数据表表达式（CTE）的查询
  - 编写使用内联表值表达式（TVF）的查询

  完成本模块后，您将能够&#58; 
  - 编写查询以返回视图结果。
  - 使用 CREATE FUNCTION 语句创建简单的嵌入式 TVF。
  - 编写查询，以从派生表中创建和检索结果。
  - 编写创建 CTE 并从数据表表达式返回结果的查询。


  ### 模块 12&#58; 使用集合运算符
  本模块介绍如何使用集合运算符UNION、INTERSECT 和 EXCEPT 比较两个输入集合之间的行。
  #### 课程
  - 使用 UNION 运算符编写查询
  - 使用 EXCEPT 和 INTERSECT
  - 使用 APPLY


  #### 实验&#58; 使用集合运算符
  - 编写使用 UNION Set 运算符和 UNION ALL 的查询
  - 编写使用 CROSS APPLY 和 OUTER APPLY 运算符的查询
  - 编写使用 EXCEPT 和 INTERSECT 运算符的查询

  学完本模块后，学生将能够&#58;
  - 编写使用 UNION 组合输入集的查询。
  - 编写使用 UNION ALL 组合输入集的查询
  - 编写使用 EXCEPT 运算符的查询，只返回一组中的行，而不返回另一组的行。
  - 编写使用 INTERSECT 运算符的查询，仅返回两个集合中都存在的行
  - 使用 CROSS APPLY 运算符编写查询。
  - 使用 OUTER APPLY 运算符编写查询


  ### 模块 13&#58; 使用 Windows 排名、偏移量和聚合函数
  本模块描述了使用窗口函数的好处。将窗口函数限制为 OVER 子句中定义的行，包括分区和框架。编写使用窗口函数对行窗口进行操作并返回排名、汇总和偏移比较结果的查询。
  #### 课程
  - 使用 OVER 创建 Windows
  - 探索窗口函数


  #### 实验&#58; 使用 Windows排名、偏移量和聚合函数
  - 编写使用排名函数的查询
  - 编写使用偏移函数的查询
  - 编写使用窗口聚合函数的查询

  学完本模块后，学生将能够&#58;
  - 描述用于定义窗口的 T-SQL 组件以及它们之间的关系。
  - 编写使用 OVER 子句的查询，并通过分区、排序和制订框架来定义窗口
  - 编写使用窗口聚合函数的查询。
  - 编写使用窗口排名函数的查询。
  - 编写使用窗口偏移量函数的查询


  ### 模块 14&#58; 数据透视和分组
  本模块描述了编写对结果集进行透视和不透视处理的查询。编写使用分组集指定多个分组的查询
  #### 课程
  - 使用 PIVOT 和 UNPIVOT 编写查询
  - 使用分组集


  #### 实验&#58; 数据透视和分组集
  - 编写使用 PIVOT 运算符的查询
  - 编写使用 UNPIVOT 运算符的查询
  - 编写使用 GROUPING SETS CUBE 和 ROLLUP 子句的查询

  学完本模块后，学生将能够&#58;
  - 描述如何在 T-SQL 查询中使用数据透视。
  - 编写使用 PIVOT 运算符的查询，以将数据从行旋转透视到列。
  - 编写使用 UNPIVOT 运算符的查询，以取消数据从列旋转透视到行。
  - 编写使用 GROUPING SETS 子句的查询。
  - 编写使用 ROLLUP 和 CUBE 的查询。
  - 编写使用 GROUPING_ID 函数的查询。


  ### 模块 15&#58; 执行存储程序
  本模块描述如何通过执行存储程序来返回结果。将参数传递给程序。创建封装 SELECT 语句的简单存储程序。使用 EXEC 和 sp_executesql 构造和执行动态 SQL。
  #### 课程
  - 使用存储程序查询数据
  - 将参数传递给存储程序
  - 建立简单的存储程序
  - 使用动态 SQL


  #### 实验&#58; 执行存储程序
  - 使用 EXECUTE 语句调用存储程序
  - 将参数传递给存储程序
  - 执行系统存储程序

  学完本模块后，学生将能够&#58;
  - 描述存储程序及其用法。
  - 编写执行存储程序以返回数据的 T-SQL 语句。
  - 编写将输入参数传递给存储程序的 EXECUTE 语句。
  - 编写准备输出参数并执行存储程序的 T-SQL 批处理。
  - 使用 CREATE PROCEDURE 语句编写存储程序。
  - 创建一个接受输入参数的存储程序。
  - 描述如何动态构建 T-SQL。
  - 编写使用动态 SQL 的查询。


  ### 模块 16&#58; 使用 T-SQL 编程
  本模块描述如何使用编程元素来增强 T-SQL 代码。
  #### 课程
  - T-SQL 编程元素
  - 控制程序流程


  #### 实验&#58; 使用 T-SQL 进行编程
  - 声明变量和定界批次
  - 使用流量控制元素
  - 在动态 SQL 语句中使用变量
  - 使用同义词

  学完本模块后，学生将能够&#58;
  - 描述 Microsoft SQL Server 如何将语句集合视为批处理。
  - 创建并提交一批 T-SQL 代码以供 SQL Server 执行。
  - 描述 SQL Server 如何将临时对象存储为变量。
  - 编写声明和分配变量的代码。
  - 创建和调用同义词
  - 描述 T-SQL 中的流程控制元素。
  - 使用 IF  ELSE 块编写 T-SQL 代码。
  - 编写使用 WHILE 的 T-SQL 代码。


  ### 模块 17&#58; 实施错误处理
  本模块介绍了 T-SQ L的错误处理。
  #### 课程
  - 实施 T-SQL 错误处理
  - 实施结构化异常处理


  #### 实验&#58; 实施错误处理
  - 使用 TRY/CATCH 复位向错误
  - 使用 THROW 将错误消息传递回客户端

  学完本模块后，学生将能够&#58;
  - 实现 T-SQL 错误处理。
  - 实施结构化异常处理。


  ### 模块 18&#58; 实施事务
  本模块描述如何实施事务。
  #### 课程
  - 事务和数据库引擎
  - 控制事务


  #### 实验&#58; 实施事务
  - 使用 BEGIN、COMMIT 和 ROLLBACK 控制事务
  - 向 CATCH 块添加错误处理

  学完本模块后，学生将能够&#58;
  - 描述事务以及批次和事务之间的差异。
  - 描述批次以及 SQL Server 如何对其进行处理。
  - 使用事务控制语言（TCL）语句创建和管理事务。
  - 使用 SET XACT_ABORT 定义 SQL Server 对 TRY/CATCH 块之外的事务的处理。

